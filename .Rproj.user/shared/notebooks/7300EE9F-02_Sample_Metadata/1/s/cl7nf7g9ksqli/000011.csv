"0",""
"0","sample_metadata = as.data.frame(SummarizedExperiment::colData(tcga_data))"
"0",""
"0","#list tissue sites"
"0","#unique(sample_metadata$site_of_resection_or_biopsy)"
"0",""
"0","source(""functions/Tissue_Rollup.R"")"
"0",""
"0","sample_metadata = sample_metadata |> "
"0","    #add generic identifier"
"0","    dplyr::mutate(sample_id = paste0(""mel"", sprintf('%0.3d', 1:length(sample_metadata$patient)))) |> "
"0","    #move sample id to front"
"0","    dplyr::select(sample_id, everything()) |> "
"0","    #remove columns"
"0","    dplyr::select(!contains(""paper_"")) |> "
"0","    #turn stage into factor"
"0","    dplyr::mutate(ajcc_pathologic_stage = factor(sample_metadata$ajcc_pathologic_stage), .keep = ""unused"") |> "
"0","    #change tumor_descriptor column to factor"
"0","    dplyr::mutate(tumor_descriptor = factor(sample_metadata$tumor_descriptor, levels = c(""Primary"", ""Metastatic""))) |> "
"0","    #remove samples without stage information"
"0","    dplyr::filter(ajcc_pathologic_stage != ""Not Reported"") |> "
"0","    #add tissue rollup"
"0","    dplyr::mutate(tissue_rollup = case_when("
"0","        site_of_resection_or_biopsy %in% Tissue_Terms$Cutaneous ~ ""Cutanous"","
"0","        site_of_resection_or_biopsy %in% Tissue_Terms$Lymph_Nodes ~ ""Lymph_Nodes"","
"0","        site_of_resection_or_biopsy %in% Tissue_Terms$CNS ~ ""CNS"","
"0","        site_of_resection_or_biopsy %in% Tissue_Terms$Mucosal ~ ""Mucosal"","
"0","        site_of_resection_or_biopsy %in% Tissue_Terms$Organ ~ ""Organ"","
"0","        site_of_resection_or_biopsy %in% Tissue_Terms$Other ~ ""Other"""
"0","    )) |> "
"0","    #censor for survival"
"0","    dplyr::mutate(survial_censor = as.integer(ifelse(is.na(days_to_death) == TRUE, ""0"", ""1""))) |> "
"0","    #days until last follow up or death"
"0","    dplyr::mutate(last_event = ifelse(survial_censor == ""1"", days_to_death, days_to_last_follow_up))"
"0",""
"0","#with(sample_metadata, table(site_of_resection_or_biopsy, tissue_rollup))"
"0",""
"0","#cleanup"
"0","rm(Tissue_Terms)"
"0",""
